<h1>Index</h1>
<ol>
<li><a href="#About">About</a></li>
<li><a href="#Dependencies">Dependencies</a></li>
<li><a href="#Installation">Installation</a>
<ul>
<li><a href="#Documentation">Documentation</a></li>
</ul>
</li>
<li><a href="#Basic_Usage">Basic Usage</a>
<ul>
<li><a href="#Examples">Examples</a></li>
</ul>
</li>
<li><a href="#Development">Development</a>
<ul>
<li><a href="#Directory_structure">Directory structure</a></li>
<li><a href="#Installing_symlinks">Installing symlinks</a></li>
</ul>
</li>
</ol>
<p><a name="About"></a></p>
<h1>lua-db - lua drawbuffers</h1>
<p>This is a Lua library for graphics programming, written in C and Lua.
It's main component is a drawbuffer, a buffer that has a width, height,
pixel format, and pixel data. There are various graphics primitives
available for the drawbuffer objects, e.g. lines, triangles, rectangles.
lua-db does not support any hardware acceleration.</p>
<p>There are multiple output options:</p>
<ul>
<li>SDL window</li>
<li>Linux framebuffer</li>
<li>Terminal output
<ul>
<li>monochrome/8bit colors/24bit colors</li>
<li>braile characters(required utf8 support, only 1 color per 2x4 pixels)</li>
<li>block characters(required utf8 support)</li>
<li>regular characters</li>
</ul>
</li>
</ul>
<p><a name="Dependencies"></a></p>
<h1>Dependencies</h1>
<p>See the respective readme's on how to install them.</p>
<ul>
<li>lua-time (runtime for examples)</li>
<li>SDL2 library for sdl module (runtime, build)</li>
<li>Linux headers for framebuffer module(build)</li>
<li>cmark(building doc)</li>
</ul>
<p><a name="Installation"></a></p>
<h1>Installation</h1>
<p>The installation is handled by the top-level makefile.</p>
<p>Simple run: <code>make install</code> in the top-level directory.</p>
<p>This will build the library, then copy the Lua files to
<code>/usr/local/share/lua/5.1/lua-db</code>, and the shared libraries to
<code>/usr/local/lib/lua/5.1/</code>.</p>
<p><a name="Documentation"></a></p>
<h2>Building Documentation</h2>
<p>The Documentation is located in doc/ in markdown format.</p>
<p>You can run &quot;make doc&quot; to generate the merged documentation in HTML and markdown.
This will also generate the index and anchor files.</p>
<p>This requires the <code>cmark</code> markdown converter to be installed and callable.</p>
<p>The merged output files will be in <code>doc/merged._md</code> and <code>doc/merged.html</code>.</p>
<p>This repository might contain a <code>doc/merged._md</code> and <code>doc/merged.html</code> for
convenience, but this might be out of date at times.</p>
<p><a name="Basic_Usage"></a></p>
<h1>Basic Usage</h1>
<p>Usually the module is loaded as:</p>
<pre><code>local ldb = require(&quot;lua-db&quot;)
</code></pre>
<p>This loads all available Lua modules and all available C modules, and returns
them in a table. (See <code>lua/init.lua</code>)</p>
<p>To load just the C core, you can use <code>require(&quot;ldb_core&quot;)</code>.</p>
<p>The main structure in lua-db is a drawbuffer. It's a userdata value with
associated metatable methods that represents a drawing surface.</p>
<p>A drawbuffer is created using the new_drawbuffer function from the core module.</p>
<pre><code>local db = ldb.new_drawbuffer(width, height, px_fmt)
</code></pre>
<p><code>width</code> and <code>height</code> are in pixels and are required. <code>px_fmt</code> specifies the pixel format and is optional. By default, a 32bpp RGBA value is used.</p>
<p>On success a drawbuffer usedata value is returned that has methods
for interaction in it's metatable.</p>
<p>On failure, nil and an error message is returned.</p>
<p><a name="Examples"></a></p>
<h2>Examples</h2>
<p>There are a bunch of examples in the <code>examples/</code> folder.
They should be run from the main directory to find the assets, if any.</p>
<p>They all share common output and input options
(defined by <code>ldb.input_output.new_from_args</code>).</p>
<p>e.g. if there is a X11 server running:</p>
<pre><code>./examples/clock.lua --sdl --width=320 --height=240
</code></pre>
<p>on a unicode terminal:</p>
<pre><code>./examples/clock.lua --halfblocks
</code></pre>
<p>The examples might leave your terminal emulator in a bad state, you might need
to run <code>reset</code>.</p>
<p>Here are a few screenshots of the running examples:</p>
<p>TODO: Add screenshots</p>
<p><a name="Development"></a></p>
<h1>Development</h1>
<p>Contributions of all kind are welcome. You can also create pull requests.
If you implement a major new feature, make sure:</p>
<ul>
<li>You don't break compatibility in a non-obvious way</li>
<li>You provide test cases for the changes</li>
<li>You provide at least basic documentation</li>
</ul>
<p><a name="Directory_structure"></a></p>
<h2>Directory structure</h2>
<p><code>doc/</code> contains the files(markdown and makefile) needed to build the documentation.</p>
<p><code>examples/</code> contains runnable example code. Some examples require assets, they are in <code>examples/data</code>.</p>
<p><code>lua/</code> contains the Lua part of this library. If you <code>require(&quot;lua-db&quot;)</code> the library normally, <code>lua/init.lua</code> is returned.</p>
<p><code>lua/gui/</code> contains the GUI library.</p>
<p><code>src/</code> contains the C part of the library. It's split into 4 parts:</p>
<ul>
<li>ldb_core (core drawbuffer functionality, but no graphics primitives),</li>
<li>ldb_gfx (graphics primitives like lines, rectangles)</li>
<li>ldb_fb (Linux framebuffer output support)</li>
<li>ldb_sdl (SDL window output support)</li>
</ul>
<p><a name="Installing_symlinks"></a></p>
<h2>Development Installation</h2>
<p>You can install symlinks instead of running <code>make install</code>.
This makes testing changes easier, as there is no need for <code>make install</code>, which
often requires sudo.</p>
<pre><code># make sure target path exists
sudo mkdir -p /usr/local/share/lua/5.1/
sudo mkdir -p /usr/local/lib/lua/5.1/

# install symlinks so make install is not needed after each change
# (adjust paths of lua-db source path)
sudo ln -s $(pwd)/lua /usr/local/share/lua/5.1/lua-db
sudo ln -s $(pwd)/src/ldb_core.so /usr/local/lib/lua/5.1/
sudo ln -s $(pwd)/src/ldb_fb.so /usr/local/lib/lua/5.1/
sudo ln -s $(pwd)/src/ldb_gfx.so /usr/local/lib/lua/5.1/
sudo ln -s $(pwd)/src/ldb_sdl.so /usr/local/lib/lua/5.1/
</code></pre>
